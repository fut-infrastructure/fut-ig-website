<?xml version="1.0" encoding="UTF-8"?>

<CapabilityStatement xmlns="http://hl7.org/fhir">
  <id value="document-query"/>
  <text>
    <status value="generated"/><div xmlns="http://www.w3.org/1999/xhtml">document-query</div>
  </text>
  <url value="http://ehealth.sundhed.dk/fhir/CapabilityStatement/document-query"/>
  <version value="4.0.0"/>
  <name value="document-query"/>
  <status value="active"/>
  <date value="2025-08-07T02:12:23.759+00:00"/>
  <publisher value="Den telemedicinske infrastruktur (eHealth Infrastructure)"/>
  <contact>
    <name value="Den telemedicinske infrastruktur (eHealth Infrastructure)"/>
    <telecom>
      <system value="url"/>
      <value value="http://ehealth.sundhed.dk"/>
    </telecom>
  </contact>
  <jurisdiction>
    <coding>
      <system value="urn:iso:std:iso:3166"/>
      <code value="DK"/>
      <display value="Denmark"/>
    </coding>
  </jurisdiction>
  <kind value="instance"/>
  <software>
    <name value="document-query"/>
    <version value="1.16.0"/>
  </software>
  <implementation>
    <description value="eHealth document-query service"/>
    <url value="https://document-query.devtest.systematic-ehealth.com/fhir"/>
  </implementation>
  <fhirVersion value="4.0.1"/>
  <format value="application/fhir+xml"/>
  <format value="xml"/>
  <format value="application/fhir+json"/>
  <format value="json"/>
  <format value="application/x-turtle"/>
  <format value="ttl"/>
  <format value="html/json"/>
  <format value="html/xml"/>
  <format value="html/turtle"/>
  <rest>
    <mode value="server"/>
    <resource>
      <type value="Binary"/>
      <profile value="http://hl7.org/fhir/StructureDefinition/Binary"/>
      <searchInclude value="*"/>
      <searchRevInclude value="DocumentReference:patient"/>
      <operation>
        <name value="retrieve-document"/>
        <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/Binary-t-retrieve-document"/>
        <documentation value="Input (url) is the element DocumentReference.content.attachment.url for metadata about the QRD/APD/PHMR document as returned from the DocumentReference search operation performing a query to national document sharing infrastructure. The url, which shall be used as-is in this operation, is an encoding of the XDS DocumentEntry.uniqueId, XDS DocumentEntry.repositoryUniqueId and XDS DocumentEntry.homeCommunityId metadata attributes needed to retrieve the document. Input (consentOverride) signifies, when set to true, that the retrieve of a document shall be performed with override of any withholding of information possibly performed  by the national document sharing service in accordance with patient's consents. Override of consents constitutes a form of break-the-glass invocation, known in Danish as værdispring.The preferred method is to call this operation without consent override and to only call with consent override when necessary. Input (reason) is mandatory when input element consentOverride is set to true. The string input is intended as a placeholder for the user's rationale for choosing to override consents.The value is logged in the Infrastructure."/>
      </operation>
    </resource>
    <resource>
      <type value="Bundle"/>
      <profile value="http://hl7.org/fhir/StructureDefinition/Bundle"/>
      <searchInclude value="*"/>
      <searchRevInclude value="DocumentReference:patient"/>
      <operation>
        <name value="retrieve-and-transform-QRD"/>
        <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/Bundle-t-retrieve-and-transform-QRD"/>
        <documentation value="Retrieves a DK-HL7 Questionnaire Response Document (QRD) XML document from national document sharing infrastructure and transforms the QRD XML document to a FHIR QuestionnaireResponse (ehealth-questionnaireresponse profile) resource.Input (url) is the element DocumentReference.content.attachment.url for metadata about the QRD document as returned from the DocumentReference search operation performing a query to national document sharing infrastructure. The url, which shall be used as-is in this operation, is an encoding of the XDS DocumentEntry.uniqueId, XDS DocumentEntry.repositoryUniqueId and XDS DocumentEntry.homeCommunityId metadata attributes needed to retrieve the document. Input (bundle) must contain a Questionnaire FHIR resource corresponding to the questionnaire definition (QFDD) that the QRD references and is a response to.Input (consentOverride) signifies, when set to true, that the retrieve of a document shall be performed with override of any withholding of information possibly performed by the national document sharing service in accordance with patient's consents. Override of consents constitutes a form of break-the-glass invocation, known in Danish as værdispring. The preferred method is to call this operation without consent override and to only call with consent override when necessary. Input (reason) is mandatory when input element consentOverride is set to true. The string input is intended as a placeholder for the user's rationale for choosing to override consents. The value is logged in the Infrastructure.The returned FHIR Bundle contains a FHIR Composition (ehealth-composition profile) resource referencing a FHIR QuestionnaireResponse (ehealth-documentreference profile) resource, if the Questionnaire FHIR resource was provided as an input, and if the transformation was successful.If the Questionnaire FHIR resource was not provided as an input, or if the transformation was not successful, the returned FHIR Bundle contains the QRD XML document that was retrieved from the national document sharing infrastructure."/>
      </operation>
      <operation>
        <name value="retrieve-and-transform-PHMR"/>
        <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/Bundle-t-retrieve-and-transform-PHMR"/>
        <documentation value="Retrieves a DK-HL7 Personal Health Monitoring Report (PHMR) XML document from national document sharing infrastructure and transforms the PHMR XML document to FHIR Observation (ehealth-observation profile) resources.Input (url) is the element DocumentReference.content.attachment.url for metadata about the PHMR document as returned from the DocumentReference search operation performing a query to national document sharing infrastructure. The url, which shall be used as-is in this operation, is an encoding of the XDS DocumentEntry.uniqueId, XDS DocumentEntry.repositoryUniqueId and XDS DocumentEntry.homeCommunityId metadata attributes needed to retrieve the document. Input (consentOverride) signifies, when set to true, that the retrieve of a document shall be performed with override of any withholding of information possibly performed by the national document sharing service in accordance with patient's consents. Override of consents constitutes a form of break-the-glass invocation, known in Danish as værdispring. The preferred method is to call this operation without consent override and to only call with consent override when necessary. Input (reason) is mandatory when input element consentOverride is set to true. The string input is intended as a placeholder for the user's rationale for choosing to override consents. The value is logged in the Infrastructure.The returned FHIR Bundle contains a FHIR Composition (ehealth-composition profile) resource referencing one or more FHIR Observation (ehealth-observation profile) resources and referenced resources such as FHIR Organization."/>
      </operation>
      <operation>
        <name value="retrieve-and-transform-APD"/>
        <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/Bundle-t-retrieve-and-transform-APD"/>
        <documentation value="Retrieves a DK-HL7 Appointment (APD) XML document from national document sharing infrastructure and transforms the APD XML document to a FHIR Appointment (ehealth-appointment profile) resource.Input (url) is the element DocumentReference.content.attachment.url for metadata about the APD document as returned from the DocumentReference search operation performing a query to national document sharing infrastructure. The url, which shall be used as-is in this operation, is an encoding of the XDS DocumentEntry.uniqueId, XDS DocumentEntry.repositoryUniqueId and XDS DocumentEntry.homeCommunityId metadata attributes needed to retrieve the document. Input (consentOverride) signifies, when set to true, that the retrieve of a document shall be performed with override of any withholding of information possibly performed by the national document sharing service in accordance with patient's consents. Override of consents constitutes a form of break-the-glass invocation, known in Danish as værdispring. The preferred method is to call this operation without consent override and to only call with consent override when necessary.Input (reason) is mandatory when input element consentOverride is set to true. The string input is intended as a placeholder for the user's rationale for choosing to override consents. The value is logged in the Infrastructure.The returned FHIR Bundle contains a FHIR Appointment (ehealth-appointment profile) resource."/>
      </operation>
    </resource>
    <resource>
      <type value="DocumentReference"/>
      <profile value="http://ehealth.sundhed.dk/fhir/StructureDefinition/ehealth-documentreference"/>
      <interaction>
        <code value="search-type"/>
      </interaction>
      <searchInclude value="*"/>
      <searchInclude value="DocumentReference:patient"/>
      <searchRevInclude value="DocumentReference:patient"/>
      <searchParam>
        <name value="status"/>
        <type value="token"/>
        <documentation value="current | superseded"/>
      </searchParam>
      <searchParam>
        <name value="category"/>
        <type value="token"/>
        <documentation value="Categorization of document"/>
      </searchParam>
      <searchParam>
        <name value="consentOverride"/>
        <type value="token"/>
        <documentation value="ConsentOverride signifies, when set to true, that the retrieve of a document shall be performed with override of any withholding of information possibly performed by the national document sharing service in accordance with patient's consents. Override of consents constitutes a form of break-the-glass invocation, known in Danish as værdispring. The preferred method is to call this operation without consent override and to only call with consent override when necessary."/>
      </searchParam>
      <searchParam>
        <name value="date"/>
        <type value="date"/>
        <documentation value="Document creation time"/>
      </searchParam>
      <searchParam>
        <name value="event"/>
        <type value="token"/>
        <documentation value="Main clinical acts documented"/>
      </searchParam>
      <searchParam>
        <name value="facility"/>
        <type value="token"/>
        <documentation value="Kind of facility where patient was seen"/>
      </searchParam>
      <searchParam>
        <name value="format"/>
        <type value="token"/>
        <documentation value="Format/content rules for the document"/>
      </searchParam>
      <searchParam>
        <name value="patient"/>
        <type value="reference"/>
        <documentation value="Who/what is the subject of the document"/>
      </searchParam>
      <searchParam>
        <name value="patient-identifier"/>
        <type value="token"/>
        <documentation value="Who/what is the subject of the document (identifier)"/>
      </searchParam>
      <searchParam>
        <name value="period"/>
        <type value="date"/>
        <documentation value="Time of service that is being documented"/>
      </searchParam>
      <searchParam>
        <name value="reason"/>
        <type value="string"/>
        <documentation value="Reason is mandatory when parameter consentOverride is set to true. The string input is intended as a placeholder for the user's rationale for choosing to override consents. The value is logged in the Infrastructure."/>
      </searchParam>
      <searchParam>
        <name value="setting"/>
        <type value="token"/>
        <documentation value="Additional details about where the content was created (e.g. clinical specialty)"/>
      </searchParam>
      <searchParam>
        <name value="type"/>
        <type value="token"/>
        <documentation value="Kind of document (LOINC if possible)"/>
      </searchParam>
    </resource>
    <resource>
      <type value="OperationDefinition"/>
      <profile value="http://hl7.org/fhir/StructureDefinition/OperationDefinition"/>
      <interaction>
        <code value="read"/>
      </interaction>
      <searchInclude value="*"/>
      <searchRevInclude value="DocumentReference:patient"/>
    </resource>
    <operation>
      <name value="reindex-terminology"/>
      <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/-s-reindex-terminology"/>
    </operation>
    <operation>
      <name value="meta"/>
      <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/-s-meta"/>
    </operation>
    <operation>
      <name value="get-resource-counts"/>
      <definition value="https://document-query.devtest.systematic-ehealth.com/fhir/OperationDefinition/-s-get-resource-counts"/>
      <documentation value="Provides the number of resources currently stored on the server, broken down by resource type"/>
    </operation>
  </rest>
</CapabilityStatement>